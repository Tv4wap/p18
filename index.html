<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <link rel="stylesheet" type="text/css" href="js.css">
  <style>
        body {
            margin: 0;
            background-color: #121212; /* Dark background */
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        #player-container {
            width: 99%;
            height: 99%;
            background: #1e1e1e; /* Dark gray background */
        }
        #player {
            width: 100%;
            height: 100%;
            margin: 1px;
        }

        
    </style>
  <!-- Clappr and Plugins -->
  <script src="https://cdn.jsdelivr.net/npm/clappr@latest/dist/clappr.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/level-selector@0.2.0/dist/level-selector.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@clappr/hlsjs-playback@1.0.1/dist/hlsjs-playback.min.js"></script>
 </head>
 <body>
  <div id="player-container">
   <div id="player"></div>
  </div>
  <script>
const urlParams = new URLSearchParams(window.location.search);
    const srcParam = urlParams.get('url');
   
        function loadPlayer() {
            var player = new Clappr.Player({ 
                source: url, // PHP-generated URL
                width: '100%',
                height: '100%',
                autoPlay: true,
                plugins: [HlsjsPlayback, LevelSelector],
                mimeType: "application/x-mpegURL",
                mediacontrol: { seekbar: "#ff8800", buttons: "#ff8800" }, /* Orange seekbar & buttons */
                parentId: "#player"
            });

            // Handle player errors and reload the stream
            player.on(Clappr.Events.PLAYER_ERROR, function(error) {
                console.log('Player error occurred:', error);

                // Destroy player and reload after a short delay
                setTimeout(function() {
                    console.log("Retrying stream...");
                    document.getElementById("player").innerHTML = ""; // Clear existing player
                    loadPlayer(); // Re-initialize the player (restarting it)
                }, 30); // Retry after 3 seconds
            });
        }

        loadPlayer(); // Initialize the player on page load
    </script>
  
 </body>
</html>
